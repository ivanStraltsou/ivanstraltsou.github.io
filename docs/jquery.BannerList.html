<!DOCTYPE html>

<html>
<head>
  <title>jquery.BannerList.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>jquery.BannerList.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h3 id="frontend-digest-44-code-wars-">FrontEnd Digest #44 code wars.</h3>
<p>This doc contains comments for initial <a href="https://dl.dropboxusercontent.com/u/69142102/__permanent/jquery.customerName.bannerlist.js">code snippet</a></p>
<p>   (c) Ivan Straltsou <a href="&#109;&#97;&#x69;&#x6c;&#116;&#111;&#x3a;&#x69;&#118;&#x61;&#110;&#95;&#x73;&#116;&#x72;&#97;&#108;&#x74;&#115;&#x6f;&#x75;&#64;&#x65;&#x70;&#x61;&#109;&#x2e;&#x63;&#111;&#x6d;">&#x69;&#118;&#x61;&#110;&#95;&#x73;&#116;&#x72;&#97;&#108;&#x74;&#115;&#x6f;&#x75;&#64;&#x65;&#x70;&#x61;&#109;&#x2e;&#x63;&#111;&#x6d;</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Use single object as argument. It’s easier to add additional arguments in future and <code>3</code> is a lot.</p>
<pre><code><span class="hljs-comment">/**
 * ...
 * @param {object} options ...
 * @param {string} options.listKey ...
 * @param {string} options.serviceRoot ...
 * @param {function} options.onSuccess ...
 */</span>
 $.fn.BannerList = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>	$.fn.BannerList = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(listKey, serviceRoot, onSuccess)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Different type of quotes in code.</p>
<p>There is no need to search for <code>/</code>. We just need to check the latest character</p>

            </div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <pre><code><span class="hljs-keyword">if</span> (serviceRoot.slice(-<span class="hljs-number">1</span>) !== <span class="hljs-string">'/'</span>) {
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">if</span> (serviceRoot.lastIndexOf(<span class="hljs-string">"/"</span>) != serviceRoot.length - <span class="hljs-number">1</span>) {
			serviceRoot = serviceRoot + <span class="hljs-string">"/"</span>;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Not standard name for this reference. Use <code>self</code>, <code>that</code>, `this_’.</p>
<p>Move variables declaration to the very beginning of the function scope.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> placeHolder = <span class="hljs-keyword">this</span>;
		<span class="hljs-keyword">var</span> list = $(<span class="hljs-string">'&lt;div id="loadingDiv"&gt;&lt;/div&gt;'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>I am not sure that fetch logic is responsibility of this plugin. It should just become data and translate it into markup.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		$.ajax({
			url: serviceRoot + <span class="hljs-string">"lists/"</span> + listKey,
			dataType: <span class="hljs-string">"json"</span>,
			cache: <span class="hljs-literal">false</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>No need to add default values.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			async: <span class="hljs-literal">true</span>,
			success: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(data)</span> </span>{
				<span class="hljs-keyword">var</span> counter = <span class="hljs-number">0</span>;
				<span class="hljs-keyword">if</span> (data.ListItems != <span class="hljs-literal">null</span>) {
					$.each(data.ListItems, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(key, listItem)</span> </span>{
						<span class="hljs-keyword">var</span> cssClass = <span class="hljs-string">'banner'</span>;
						<span class="hljs-keyword">var</span> cssId = <span class="hljs-string">''</span>;
						<span class="hljs-keyword">var</span> cssStyle = <span class="hljs-string">''</span>;
						<span class="hljs-keyword">var</span> imgScr = <span class="hljs-string">''</span>;
						<span class="hljs-keyword">var</span> alt = <span class="hljs-string">' alt=""'</span>;

						<span class="hljs-keyword">if</span> (counter == <span class="hljs-number">0</span>) {
							cssId = <span class="hljs-string">'banner1'</span>;
							cssStyle = <span class="hljs-string">'display: ;'</span>;
							imgScr = <span class="hljs-string">'Customers/HiddenName/Content/images/panel/panel1-sml.jpg'</span>
						}
						<span class="hljs-keyword">if</span> (counter == <span class="hljs-number">1</span>) {
							cssId = <span class="hljs-string">'banner2'</span>;
							cssStyle = <span class="hljs-string">'display: none;'</span>;
							imgScr = <span class="hljs-string">'Customers/HiddenName/Content/images/panel/panel2-sml.jpg'</span>
						}
						<span class="hljs-keyword">if</span> (counter == <span class="hljs-number">2</span>) {
							cssId = <span class="hljs-string">'banner3'</span>;
							cssStyle = <span class="hljs-string">'display: none;'</span>;
							imgScr = <span class="hljs-string">'Customers/HiddenName/Content/images/panel/panel3-sml.jpg'</span>
						}</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>if (counter == data.ListItems.length - 1) cssClass = ‘last’;</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						<span class="hljs-keyword">if</span> (cssClass != <span class="hljs-string">''</span>) { cssClass = <span class="hljs-string">'class="'</span> + cssClass + <span class="hljs-string">'" '</span>; }
						<span class="hljs-keyword">if</span> (cssId != <span class="hljs-string">''</span>) { cssId = <span class="hljs-string">'id="'</span> + cssId + <span class="hljs-string">'" '</span>; }
						<span class="hljs-keyword">if</span> (cssStyle != <span class="hljs-string">''</span>) { cssStyle = <span class="hljs-string">'style="'</span> + cssStyle + <span class="hljs-string">'" '</span>; }

						<span class="hljs-keyword">if</span> (listItem.Properties != <span class="hljs-literal">null</span>) {
							imgScr = listItem.Properties[<span class="hljs-number">0</span>].Value;
						}
						<span class="hljs-keyword">if</span> (imgScr != <span class="hljs-string">''</span>) { imgScr = <span class="hljs-string">'src="'</span> + imgScr + <span class="hljs-string">'" '</span>; }

						<span class="hljs-keyword">var</span> itemContent = <span class="hljs-literal">null</span>;
						<span class="hljs-keyword">if</span> (listItem.Link != <span class="hljs-literal">null</span>) {
							itemContent = <span class="hljs-string">"&lt;a href='"</span> + listItem.Link + <span class="hljs-string">"'&gt; &lt;img "</span> + imgScr + alt + <span class="hljs-string">"/&gt;"</span> + <span class="hljs-string">"&lt;/a&gt;"</span>;
						} <span class="hljs-keyword">else</span> {
							itemContent = listItem.Name;
						}

						list.before($(<span class="hljs-string">"&lt;div "</span> + cssId + cssClass + cssStyle + <span class="hljs-string">"&gt;"</span> + itemContent + <span class="hljs-string">"&lt;/div&gt;"</span>));
						counter++;
					});
				}
				<span class="hljs-keyword">if</span> (onSuccess &amp;&amp; <span class="hljs-keyword">typeof</span> onSuccess == <span class="hljs-string">'function'</span>) {
					onSuccess(list);
				}
				placeHolder.prepend(list);</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>This return statement will take no effect. It should be placed to the end of plugin-function to enable chaining.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
			},
			error: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(xhr, ajaxOptions, thrownError)</span> </span>{
				GOD.Ajax.checkError(xhr, ajaxOptions, thrownError);
			}
		});</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Add <code>return this;</code> to enable chaining.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	};
})(jQuery);</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
